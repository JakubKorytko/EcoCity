<content>
  <main>
    <section>
      <img src="/public/images/reports/placeholder.png" alt="Report Icon" />
      <div>
        <h3>Report title</h3>
        <p>Somewhere</p>
        <div>
          <span>Time difference</span>
          <span></span>
        </div>
      </div>
    </section>
    <section>
      <div>Status</div>
      <div>
        <NavLink to="/reports">View</NavLink>
        <!--        <button>View</button>-->
        <button>Edit</button>
      </div>
    </section>
  </main>
</content>

<script>
  import getDistanceToLocation from "/modules/location.pig";

  const { data } = $attrs;

  $element("NavLink").setAttribute("to", `/report?id=${data.id}`);

  getDistanceToLocation(data.geoLocation?.latitude, data.geoLocation?.longitude)
    .then(({ distanceKm }) => {
      $element(
        "main > section:first-of-type > div span:last-of-type",
      ).textContent = `${distanceKm.toFixed(2)} km away` || "";
    })
    .catch(console.warn);

  console.log(data);

  $element("main > section:first-of-type > img").src =
    data.image || "/public/images/reports/placeholder.png";
  $element("main > section:first-of-type h3").textContent =
    data.title || "Report title";
  $element("main > section:first-of-type p").textContent =
    data.geoLocation?.city || "Somewhere";

  $element(
    "main > section:first-of-type > div span:first-of-type",
  ).textContent = data.timeDifference || "Time difference";
  $element("main > section:nth-of-type(2) > div").textContent =
    data.status || "Status";
</script>

<style>
  :host {
    width: 100%;

    main {
      padding: 24px;
      width: 100%;
      display: flex;
      flex-direction: row;
      justify-content: space-between;

      section {
        &:first-of-type {
          display: flex;
          flex-direction: row;
          align-items: center;

          img {
            width: 48px;
            height: 48px;
          }
        }

        &:nth-of-type(2) {
          display: flex;
          flex-direction: column;

          div:last-of-type {
            display: flex;
            flex-direction: row;
            gap: 16px;
          }
        }
      }
    }
  }
</style>
